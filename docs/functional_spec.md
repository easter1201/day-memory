# 기능 상세 명세서 (Functional Detail Spec) - Day Memory

## 📋 개요
각 기능의 입력 값, 처리 방식, 출력 결과를 구체적으로 정의하는 문서입니다. 프론트엔드에서 구현해야 할 로직과 화면 동작을 명확히 합니다.

---

## 🔐 인증 기능

### 기능명: 회원가입
- **입력**: 이메일, 비밀번호, 비밀번호 확인, 닉네임
- **유효성 검증**:
  - 이메일: 올바른 이메일 형식 (정규식 검증)
  - 비밀번호: 최소 8자 이상, 영문/숫자/특수문자 조합
  - 비밀번호 확인: 비밀번호와 일치 여부 확인
  - 닉네임: 2~20자 이내
- **처리**:
  - 모든 필드 입력 완료 및 유효성 검증 통과 → 가입 버튼 활성화
  - API 요청: `POST /api/auth/signup`
  - 성공 시 성공 메시지 표시
  - 실패 시 에러 메시지 표시 (이미 존재하는 이메일 등)
- **출력**:
  - 성공: `/login` 페이지로 리다이렉트
  - 실패: 에러 메시지 표시 및 입력 유지

### 기능명: 로그인
- **입력**: 이메일, 비밀번호
- **처리**:
  - API 요청: `POST /api/auth/login`
  - 성공 시 JWT 토큰을 로컬 스토리지에 저장
  - 실패 시 에러 메시지 표시
- **출력**:
  - 성공: `/dashboard` 페이지로 리다이렉트
  - 실패: 에러 메시지 표시 ("이메일 또는 비밀번호가 일치하지 않습니다")

### 기능명: 로그아웃
- **입력**: 로그아웃 버튼 클릭
- **처리**:
  - 로컬 스토리지에서 JWT 토큰 삭제
  - Redux 상태 초기화
- **출력**: `/login` 페이지로 리다이렉트

### 기능명: 비밀번호 재설정
- **입력**: 이메일
- **처리**:
  - API 요청: `POST /api/auth/password-reset`
  - 입력한 이메일로 비밀번호 재설정 링크 발송
- **출력**: "이메일이 발송되었습니다" 메시지 표시

---

## 📅 이벤트 관리 기능

### 기능명: 이벤트 목록 조회
- **입력**: 없음 (또는 필터 옵션)
- **처리**:
  - API 요청: `GET /api/events`
  - 필터링: 다가오는 이벤트 (`?filter=upcoming`), 지난 이벤트 (`?filter=past`)
  - 이벤트 카드 형식으로 표시 (이벤트명, D-Day, 날짜, 타입)
- **출력**: 이벤트 카드 그리드 렌더링

### 기능명: 이벤트 검색
- **입력**: 검색어 (문자열)
- **처리**:
  - 프론트엔드에서 이벤트 목록 필터링 (이벤트명 기준)
  - 또는 API 요청: `GET /api/events?search={keyword}`
- **출력**: 필터링된 이벤트 카드 리스트 표시

### 기능명: 이벤트 생성
- **입력**:
  - 이벤트명 (필수)
  - 날짜 (필수)
  - 이벤트 타입 (필수: 생일, 기념일, 특별한 날 등)
  - 대상자 (선택)
  - 관계 (선택: 가족, 친구, 연인 등)
  - 메모 (선택)
  - 추적 여부 (boolean, 기본값 true)
  - 리마인더 설정 (array: 30일 전, 14일 전 등)
- **유효성 검증**:
  - 이벤트명: 1~50자 이내
  - 날짜: 유효한 날짜 형식
- **처리**:
  - API 요청: `POST /api/events`
  - 성공 시 생성된 이벤트 상세 페이지로 이동
  - 실패 시 에러 메시지 표시
- **출력**:
  - 성공: `/events/:id` 페이지로 리다이렉트
  - 실패: 에러 메시지 표시

### 기능명: 이벤트 상세 조회
- **입력**: 이벤트 ID
- **처리**:
  - API 요청: `GET /api/events/:id`
  - 이벤트 정보, D-Day 계산, 리마인더 목록, 연결된 선물 목록 표시
- **출력**: 이벤트 상세 정보 렌더링

### 기능명: D-Day 계산
- **입력**: 이벤트 날짜
- **처리**:
  - 현재 날짜와 이벤트 날짜 간의 차이 계산
  - 남은 일수 또는 지난 일수 표시
- **출력**:
  - D-7 (7일 남음)
  - D+3 (3일 지남)
  - D-Day (오늘)

### 기능명: 이벤트 수정
- **입력**: 수정할 이벤트 정보 (이벤트 생성과 동일한 필드)
- **처리**:
  - API 요청: `PUT /api/events/:id`
  - 성공 시 수정된 이벤트 상세 페이지로 이동
- **출력**:
  - 성공: `/events/:id` 페이지로 리다이렉트
  - 실패: 에러 메시지 표시

### 기능명: 이벤트 삭제
- **입력**: 삭제 확인 다이얼로그
- **처리**:
  - 확인 다이얼로그 표시 ("정말 삭제하시겠습니까?")
  - 확인 시 API 요청: `DELETE /api/events/:id`
- **출력**:
  - 성공: `/events` 페이지로 리다이렉트 + 성공 메시지
  - 실패: 에러 메시지 표시

---

## 🎁 선물 관리 기능

### 기능명: 선물 목록 조회
- **입력**: 없음 (또는 필터 옵션)
- **처리**:
  - API 요청: `GET /api/gifts`
  - 필터링: 카테고리별 (`?category=꽃`), 구매 완료 (`?purchased=true`)
- **출력**: 선물 카드 그리드 렌더링

### 기능명: 선물 검색
- **입력**: 검색어 (문자열)
- **처리**:
  - 프론트엔드에서 선물 목록 필터링 (선물명 기준)
  - 또는 API 요청: `GET /api/gifts?search={keyword}`
- **출력**: 필터링된 선물 카드 리스트 표시

### 기능명: 선물 추가
- **입력**:
  - 선물명 (필수)
  - 카테고리 (필수: 꽃, 주얼리, 화장품 등)
  - 가격 (선택)
  - URL (선택)
  - 메모 (선택)
  - 구매 여부 (boolean, 기본값 false)
  - 연결 이벤트 선택 (선택)
- **유효성 검증**:
  - 선물명: 1~50자 이내
  - 가격: 숫자만 입력 가능
  - URL: 유효한 URL 형식 (선택)
- **처리**:
  - API 요청: `POST /api/gifts`
  - 성공 시 선물 목록 페이지로 이동
- **출력**:
  - 성공: `/gifts` 페이지로 리다이렉트 + 성공 메시지
  - 실패: 에러 메시지 표시

### 기능명: 선물 상세 조회
- **입력**: 선물 ID
- **처리**:
  - API 요청: `GET /api/gifts/:id`
  - 선물 정보, 연결된 이벤트 정보 표시
- **출력**: 선물 상세 정보 렌더링

### 기능명: 선물 구매 완료 토글
- **입력**: 구매 완료 체크박스 클릭
- **처리**:
  - API 요청: `PATCH /api/gifts/:id/purchase`
  - 구매 여부 상태 토글 (true ↔ false)
- **출력**: UI 업데이트 (체크박스 상태 변경, 카드 스타일 변경)

### 기능명: 선물 수정
- **입력**: 수정할 선물 정보 (선물 추가와 동일한 필드)
- **처리**:
  - API 요청: `PUT /api/gifts/:id`
  - 성공 시 선물 상세 페이지로 이동
- **출력**:
  - 성공: `/gifts/:id` 페이지로 리다이렉트
  - 실패: 에러 메시지 표시

### 기능명: 선물 삭제
- **입력**: 삭제 확인 다이얼로그
- **처리**:
  - 확인 다이얼로그 표시
  - 확인 시 API 요청: `DELETE /api/gifts/:id`
- **출력**:
  - 성공: `/gifts` 페이지로 리다이렉트
  - 실패: 에러 메시지 표시

---

## 🤖 AI 선물 추천 기능

### 기능명: AI 추천 요청
- **입력**:
  - 이벤트 선택 (필수)
  - 예산 (선택)
  - 선호 카테고리 (선택: 다중 선택 가능)
  - 추가 메시지 (선택)
- **처리**:
  - API 요청: `POST /api/ai/recommendations`
  - 요청 데이터: `{ eventId, budget, categories, message }`
  - AI 처리 중 로딩 표시 (스피너 또는 진행 메시지)
- **출력**:
  - 성공: `/recommendations/:id` 페이지로 리다이렉트 (추천 결과 표시)
  - 실패: 에러 메시지 표시

### 기능명: AI 추천 결과 조회
- **입력**: 추천 ID
- **처리**:
  - API 요청: `GET /api/ai/recommendations/:id`
  - 사용자 저장 선물 우선 표시
  - AI 추천 선물 목록 + 추천 이유 표시
- **출력**:
  - 사용자 저장 선물 섹션 (상단)
  - AI 추천 선물 섹션 (하단, 각 선물별 추천 이유 포함)

### 기능명: 추천 선물 저장
- **입력**: 추천 결과에서 선물 선택 + 저장 버튼 클릭
- **처리**:
  - API 요청: `POST /api/gifts` (선택한 추천 선물을 내 선물 리스트에 저장)
  - 성공 시 "선물이 저장되었습니다" 메시지 표시
- **출력**: 성공 메시지 + UI 업데이트 (저장 버튼 비활성화)

---

## ⏰ 리마인더 기능

### 기능명: 리마인더 설정
- **입력**:
  - 이벤트별 리마인더 일수 설정 (30일 전, 14일 전, 7일 전 등)
  - 리마인더 활성화/비활성화 토글
- **처리**:
  - API 요청: `POST /api/reminders` (이벤트 생성 시)
  - 또는 `PUT /api/reminders/:id` (수정)
- **출력**: 리마인더 설정 저장 완료 메시지

### 기능명: 리마인더 발송 내역 조회
- **입력**: 없음 (또는 필터: 전체, 성공, 실패)
- **처리**:
  - API 요청: `GET /api/reminders/logs`
  - 테이블 형식으로 표시 (날짜, 이벤트명, 수신자, 상태)
- **출력**: 리마인더 발송 내역 테이블 렌더링

### 기능명: 리마인더 재발송
- **입력**: 실패한 리마인더 로그 ID + 재시도 버튼 클릭
- **처리**:
  - API 요청: `POST /api/reminders/retry/:reminderLogId`
  - 재발송 시도
- **출력**:
  - 성공: 성공 메시지 + 상태 업데이트
  - 실패: 에러 메시지 표시

---

## 📆 캘린더 기능

### 기능명: 월별 캘린더 표시
- **입력**: 년/월 정보
- **처리**:
  - API 요청: `GET /api/events?year={year}&month={month}`
  - 해당 월의 이벤트 조회
  - 캘린더 그리드에 이벤트 마커 표시
- **출력**: 월별 캘린더 렌더링 (이벤트가 있는 날짜에 마커 표시)

### 기능명: 날짜 클릭 시 이벤트 팝업
- **입력**: 날짜 클릭
- **처리**:
  - 해당 날짜의 이벤트 목록 필터링
  - 팝업으로 이벤트 리스트 표시
- **출력**: 이벤트 목록 팝업 (이벤트명, 시간, 타입)

### 기능명: 월 이동
- **입력**: 이전 월 / 다음 월 버튼 클릭
- **처리**:
  - 현재 년/월 상태 업데이트
  - 새로운 년/월 기준으로 API 재요청
- **출력**: 업데이트된 캘린더 렌더링

---

## ⚙️ 설정 기능

### 기능명: 프로필 수정
- **입력**: 프로필 사진, 닉네임
- **유효성 검증**:
  - 닉네임: 2~20자 이내
  - 프로필 사진: 이미지 파일만 허용 (jpg, png, gif)
- **처리**:
  - API 요청: `PUT /api/users/profile`
  - 프로필 사진 업로드 (multipart/form-data)
- **출력**:
  - 성공: "프로필이 수정되었습니다" 메시지
  - 실패: 에러 메시지 표시

### 기능명: 알림 설정 변경
- **입력**:
  - 이메일 알림 on/off (boolean)
  - 리마인더 발송 시간 (09:00, 12:00, 18:00 중 선택)
- **처리**:
  - API 요청: `PUT /api/users/notification-settings`
- **출력**: "알림 설정이 변경되었습니다" 메시지

### 기능명: 비밀번호 변경
- **입력**: 현재 비밀번호, 새 비밀번호, 새 비밀번호 확인
- **유효성 검증**:
  - 새 비밀번호: 최소 8자 이상, 영문/숫자/특수문자 조합
  - 새 비밀번호 확인: 새 비밀번호와 일치 여부
- **처리**:
  - API 요청: `PUT /api/users/password`
  - 현재 비밀번호 검증
- **출력**:
  - 성공: "비밀번호가 변경되었습니다" 메시지
  - 실패: "현재 비밀번호가 일치하지 않습니다" 또는 기타 에러 메시지

### 기능명: 계정 삭제
- **입력**: 삭제 확인 다이얼로그 + 비밀번호 재입력
- **처리**:
  - 경고 다이얼로그 표시 ("계정 삭제 시 모든 데이터가 삭제되며 복구할 수 없습니다")
  - 비밀번호 확인
  - API 요청: `DELETE /api/users/account`
- **출력**:
  - 성공: 로그아웃 + `/` 페이지로 리다이렉트
  - 실패: 에러 메시지 표시

---

## 📊 대시보드 기능

### 기능명: 다가오는 이벤트 위젯
- **입력**: 없음
- **처리**:
  - API 요청: `GET /api/events?upcoming=true&limit=5`
  - 향후 30일 이내 이벤트 5개 조회
- **출력**: 이벤트 카드 리스트 (이벤트명, D-Day)

### 기능명: 통계 카드
- **입력**: 없음
- **처리**:
  - API 요청: `GET /api/dashboard/statistics`
  - 총 이벤트 수, 총 선물 수, 이번 달 이벤트 수 조회
- **출력**: 통계 카드 3개 렌더링

### 기능명: 빠른 액션 버튼
- **입력**: 버튼 클릭
- **처리**:
  - "새 이벤트 추가" → `/events/new` 페이지로 이동
  - "새 선물 추가" → `/gifts/new` 페이지로 이동
  - "AI 추천 요청" → `/recommendations/new` 페이지로 이동
- **출력**: 해당 페이지로 네비게이션

---

## 🔍 검색 및 필터링 공통 로직

### 기능명: 실시간 검색
- **입력**: 검색어 입력 (onChange 이벤트)
- **처리**:
  - 디바운싱 적용 (300ms 지연 후 검색 실행)
  - 프론트엔드에서 배열 필터링 또는 API 요청
- **출력**: 필터링된 결과 리스트 렌더링

### 기능명: 카테고리 필터
- **입력**: 카테고리 버튼 클릭
- **처리**:
  - 선택된 카테고리 상태 업데이트
  - API 요청에 카테고리 파라미터 추가
  - 또는 프론트엔드에서 배열 필터링
- **출력**: 필터링된 결과 리스트 렌더링

---

## 🎨 UI 인터랙션

### 기능명: 페이지네이션
- **입력**: 페이지 번호 클릭
- **처리**:
  - 현재 페이지 상태 업데이트
  - API 요청: `?page={pageNumber}&size=12`
- **출력**: 해당 페이지의 아이템 목록 렌더링

### 기능명: 로딩 상태
- **처리**:
  - API 요청 시작 시 로딩 상태 활성화
  - API 요청 완료/실패 시 로딩 상태 비활성화
- **출력**: 로딩 스피너 또는 스켈레톤 UI 표시

### 기능명: 에러 처리
- **처리**:
  - API 요청 실패 시 에러 메시지 캡처
  - 에러 타입별 메시지 표시 (400, 401, 404, 500 등)
- **출력**:
  - 토스트 메시지 또는 경고 배너
  - 401 Unauthorized → 자동 로그아웃 + `/login` 리다이렉트

---

**작성일**: 2025-01-11
**버전**: 1.0
**참고**: project_idea.md, ia_structure.md, page_definition.md 기반 작성
